<script>
    // Random Hero Image - Execute immediately for no flash
    (function () {
        const heroImages = [
            'img104.jpg', 'img108.jpg', 'img114.jpg', 'img120.jpg', 'img124.jpg',
            'img128.jpg', 'img132.jpg', 'img138.jpg', 'img144.jpg', 'img148.jpg',
            'img152.jpg', 'img162.jpg', 'img168.jpg', 'img18.jpg', 'img24.jpg',
            'img252.jpg', 'img46.jpg', 'img50.jpg', 'img62.jpg', 'img66.jpg',
            'img70.jpg', 'img74.jpg', 'img82.jpg', 'img90.jpg', 'img94.jpg'
        ];
        const randomImage = heroImages[Math.floor(Math.random() * heroImages.length)];
        const heroBg = document.getElementById('hero-bg-image');
        if (heroBg) {
            heroBg.src = '/images/ilustrasi/' + randomImage;
            heroBg.style.display = '';
        }
    })();

    // Mobile Menu Toggle - Offcanvas Panel
    const menuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuOverlay = document.getElementById('mobile-menu-overlay');
    const menuIconOpen = document.getElementById('menu-icon-open');
    const menuIconClose = document.getElementById('menu-icon-close');
    let isMenuOpen = false;

    function openMenu() {
        isMenuOpen = true;
        mobileMenu.classList.remove('translate-x-full');
        mobileMenu.classList.add('translate-x-0');
        menuOverlay.classList.remove('opacity-0', 'pointer-events-none');
        menuOverlay.classList.add('opacity-100', 'pointer-events-auto');
        menuIconOpen.classList.add('hidden');
        menuIconClose.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }

    function closeMenu() {
        isMenuOpen = false;
        mobileMenu.classList.add('translate-x-full');
        mobileMenu.classList.remove('translate-x-0');
        menuOverlay.classList.add('opacity-0', 'pointer-events-none');
        menuOverlay.classList.remove('opacity-100', 'pointer-events-auto');
        menuIconOpen.classList.remove('hidden');
        menuIconClose.classList.add('hidden');
        document.body.style.overflow = '';
    }

    if (menuBtn) {
        menuBtn.addEventListener('click', () => {
            if (isMenuOpen) {
                closeMenu();
            } else {
                openMenu();
            }
        });
    }

    // Close menu when clicking overlay
    if (menuOverlay) {
        menuOverlay.addEventListener('click', closeMenu);
    }

    // Close menu when clicking a link
    if (mobileMenu) {
        mobileMenu.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', closeMenu);
        });
    }

    // Intersection Observer for Reveal Effect
    document.addEventListener('DOMContentLoaded', () => {
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.15
        };

        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, observerOptions);

        const revealElements = document.querySelectorAll('.reveal');
        revealElements.forEach(el => observer.observe(el));
    });

    // Netlify Identity Widget
    if (window.netlifyIdentity) {
        window.netlifyIdentity.on("init", user => {
            if (!user) {
                window.netlifyIdentity.on("login", () => {
                    document.location.href = "/admin/";
                });
            }
        });
    }
</script>